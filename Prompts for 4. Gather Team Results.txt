Remember this for now. Inside each of the json files I just downloaded, there is information on matches. Each json file will have several matches in it held in "meets". The json format for a typical meet looks like this: "meets": [ { "id": 197883, "title": "Vale v La Grande", "meetDateTime": "2025-05-08T06:00:00.000Z", "postSeason": false, "approveMeet": true, "eventId": null, "winnerSchoolId": null, "coach": { "schoolId": 74596, "firstName": "Randy", "lastName": "Seals", "genderId": 2, "email": "rseals@malesd.org", "phone": "(541) 212-5579", "school": { "name": "Vale" } }, "schools": { "winners": [ { "id": 74596, "name": "Vale", "score": 6, "winnerSchoolId": null } ], "losers": [ { "id": 75227, "name": "LA GRANDE HIGH SCHOOL", "score": 1, "winnerSchoolId": null } ] }, "matches": { "Singles": [ { "sets": [ { "2645435": 6, "2645436": 2, "number": 1, "tie": null }, { "2645435": 6, "2645436": 3, "number": 2, "tie": null } ], "id": 1322751, "flight": "1", "matchType": "Singles", "finish": null, "winnerTeamId": 2645435, "genderId": 2, "isNotVarsity": false, "matchTeams": [ { "id": 2645435, "isWinner": true, "players": [ { "id": 163020, "firstName": "Avery", "lastName": "Schiemer", "grade": "10", "genderId": 2, "schoolId": 74596, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "Vale" }, "matchTeamPlayer": { "position": 1 } } ] }, { "id": 2645436, "isWinner": false, "players": [ { "id": 129948, "firstName": "Addison", "lastName": "Berry", "grade": "12", "genderId": 2, "schoolId": 75227, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "LA GRANDE HIGH SCHOOL" }, "matchTeamPlayer": { "position": 1 } } ] } ] }, { "sets": [ { "2645477": 6, "2645478": 3, "number": 1, "tie": null }, { "2645477": 6, "2645478": 2, "number": 2, "tie": null } ], "id": 1322772, "flight": "2", "matchType": "Singles", "finish": null, "winnerTeamId": 2645477, "genderId": 2, "isNotVarsity": false, "matchTeams": [ { "id": 2645477, "isWinner": true, "players": [ { "id": 104187, "firstName": "Autumn", "lastName": "Jones", "grade": "Graduated", "genderId": 2, "schoolId": 74596, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": "2025-06-18T18:44:19.000Z", "school": { "name": "Vale" }, "matchTeamPlayer": { "position": 1 } } ] }, { "id": 2645478, "isWinner": false, "players": [ { "id": 124903, "firstName": "Mallie", "lastName": "Gitome", "grade": "12", "genderId": 2, "schoolId": 75227, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "LA GRANDE HIGH SCHOOL" }, "matchTeamPlayer": { "position": 1 } } ] } ] }, { "sets": [ { "2645497": 6, "2645498": 7, "number": 1, "tie": 2 }, { "2645497": 7, "2645498": 6, "number": 2, "tie": 5 }, { "2645497": 10, "2645498": 4, "number": 3, "tie": null } ], "id": 1322782, "flight": "3", "matchType": "Singles", "finish": null, "winnerTeamId": 2645497, "genderId": 2, "isNotVarsity": false, "matchTeams": [ { "id": 2645497, "isWinner": true, "players": [ { "id": 121019, "firstName": "Hazel", "lastName": "Mckrola", "grade": "12", "genderId": 2, "schoolId": 74596, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "Vale" }, "matchTeamPlayer": { "position": 1 } } ] }, { "id": 2645498, "isWinner": false, "players": [ { "id": 143242, "firstName": "Elle", "lastName": "Edvalson", "grade": "12", "genderId": 2, "schoolId": 75227, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "LA GRANDE HIGH SCHOOL" }, "matchTeamPlayer": { "position": 1 } } ] } ] } ], "Doubles": [ { "sets": [ { "2645507": 6, "2645508": 0, "number": 1, "tie": null }, { "2645507": 6, "2645508": 1, "number": 2, "tie": null } ], "id": 1322787, "flight": "1", "matchType": "Doubles", "finish": null, "winnerTeamId": 2645507, "genderId": 2, "isNotVarsity": false, "matchTeams": [ { "id": 2645507, "isWinner": true, "players": [ { "id": 101459, "firstName": "Elise", "lastName": "Seals", "grade": "Graduated", "genderId": 2, "schoolId": 74596, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": "2025-06-18T18:44:19.000Z", "school": { "name": "Vale" }, "matchTeamPlayer": { "position": 1 } }, { "id": 141895, "firstName": "Ellie", "lastName": "Seals", "grade": "11", "genderId": 2, "schoolId": 74596, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "Vale" }, "matchTeamPlayer": { "position": 2 } } ] }, { "id": 2645508, "isWinner": false, "players": [ { "id": 129947, "firstName": "LeAnna", "lastName": "Scott", "grade": "12", "genderId": 2, "schoolId": 75227, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "LA GRANDE HIGH SCHOOL" }, "matchTeamPlayer": { "position": 1 } }, { "id": 165713, "firstName": "Maddison", "lastName": "Armstrong", "grade": "12", "genderId": 2, "schoolId": 75227, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "LA GRANDE HIGH SCHOOL" }, "matchTeamPlayer": { "position": 2 } } ] } ] }, { "sets": [ { "2645523": 6, "2645524": 4, "number": 1, "tie": null }, { "2645523": 6, "2645524": 2, "number": 2, "tie": null } ], "id": 1322795, "flight": "2", "matchType": "Doubles", "finish": null, "winnerTeamId": 2645523, "genderId": 2, "isNotVarsity": false, "matchTeams": [ { "id": 2645523, "isWinner": true, "players": [ { "id": 121018, "firstName": "Megan ", "lastName": "Schoorl", "grade": "12", "genderId": 2, "schoolId": 74596, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "Vale" }, "matchTeamPlayer": { "position": 2 } }, { "id": 121022, "firstName": "Ella ", "lastName": "Nieskens", "grade": "12", "genderId": 2, "schoolId": 74596, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "Vale" }, "matchTeamPlayer": { "position": 1 } } ] }, { "id": 2645524, "isWinner": false, "players": [ { "id": 143251, "firstName": "Karli", "lastName": "Kretschmer", "grade": "12", "genderId": 2, "schoolId": 75227, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "LA GRANDE HIGH SCHOOL" }, "matchTeamPlayer": { "position": 1 } }, { "id": 149968, "firstName": "Irelyn", "lastName": "Collins", "grade": "12", "genderId": 2, "schoolId": 75227, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "LA GRANDE HIGH SCHOOL" }, "matchTeamPlayer": { "position": 2 } } ] } ] }, { "sets": [ { "2645531": 6, "2645532": 0, "number": 1, "tie": null }, { "2645531": 6, "2645532": 1, "number": 2, "tie": null } ], "id": 1322799, "flight": "3", "matchType": "Doubles", "finish": null, "winnerTeamId": 2645531, "genderId": 2, "isNotVarsity": false, "matchTeams": [ { "id": 2645531, "isWinner": true, "players": [ { "id": 121021, "firstName": "Janet", "lastName": "Gonzalez", "grade": "12", "genderId": 2, "schoolId": 74596, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "Vale" }, "matchTeamPlayer": { "position": 1 } }, { "id": 163028, "firstName": "Marli", "lastName": "Bennett", "grade": "10", "genderId": 2, "schoolId": 74596, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "Vale" }, "matchTeamPlayer": { "position": 2 } } ] }, { "id": 2645532, "isWinner": false, "players": [ { "id": 165718, "firstName": "Ava", "lastName": "Mendoza", "grade": "10", "genderId": 2, "schoolId": 75227, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "LA GRANDE HIGH SCHOOL" }, "matchTeamPlayer": { "position": 1 } }, { "id": 165726, "firstName": "Eve", "lastName": "Grigg", "grade": "10", "genderId": 2, "schoolId": 75227, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "LA GRANDE HIGH SCHOOL" }, "matchTeamPlayer": { "position": 2 } } ] } ] }, { "sets": [ { "2645541": 3, "2645542": 8, "number": 1, "tie": null } ], "id": 1322804, "flight": "4", "matchType": "Doubles", "finish": null, "winnerTeamId": 2645542, "genderId": 2, "isNotVarsity": false, "matchTeams": [ { "id": 2645541, "isWinner": false, "players": [ { "id": 121020, "firstName": "Madison", "lastName": "Baker", "grade": "12", "genderId": 2, "schoolId": 74596, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "Vale" }, "matchTeamPlayer": { "position": 2 } }, { "id": 141896, "firstName": "Rachel", "lastName": "Ainsworth", "grade": "11", "genderId": 2, "schoolId": 74596, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "Vale" }, "matchTeamPlayer": { "position": 1 } } ] }, { "id": 2645542, "isWinner": true, "players": [ { "id": 143241, "firstName": "Kendal", "lastName": "DeYoung", "grade": "Graduated", "genderId": 2, "schoolId": 75227, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": "2025-06-18T18:44:19.000Z", "school": { "name": "LA GRANDE HIGH SCHOOL" }, "matchTeamPlayer": { "position": 2 } }, { "id": 165725, "firstName": "Ellison", "lastName": "Summers", "grade": "10", "genderId": 2, "schoolId": 75227, "updatedAt": "2025-06-18T18:37:50.000Z", "graduatedDate": null, "school": { "name": "LA GRANDE HIGH SCHOOL" }, "matchTeamPlayer": { "position": 1 } } ] } ] } ] }, "event": null } ]


Now we need to create a list of all the team matches. The data is in the format you saved for meets.

We will need to loop through all the downloaded files.The list of files is stored in schools_with_json_files.csv, which has a header called filename.

For each meet, we will need:
1) The id for the meet, rename as team_match_id
2) The winning school name (rename as winning_team_name) - from "schools"/"winners"/"name"
3) The winning school id (rename as winning_team_id) - from "schools"/"winners"/"id"
4) The winning school score (rename as winning_team_win_cnt) - from "schools"/"winners"/"score"
5) The losing school name (rename as losing_team_name) - from "schools"/"losers"/"name"
6) The winning school id (rename as losing_team_id) - from "schools"/"losers"/"id"
7) The winning school score (rename as losing_team_win_cnt) - from "schools"/"losers"/"score"
8) The date of the match (extracted from "meetDateTime"

Once you have looped through all the schools and gathered all the matches, the full list needs to be deduped so that you keep only one version of the match (dedupe when all 8 fields are identical). Place the full results into a csv file called all_team_matches.csv.




That looks good, except you left match_date as a timestamp. I need that formatted as a date instead.